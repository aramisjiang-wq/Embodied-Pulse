# AI编程项目规则

> 每次新建项目时复制到项目根目录的 .trae/rules/ 下

---

## 一、项目启动流程

### 1.1 创建文档目录结构

```
项目根目录/
├── .trae/
│   └── rules/
│       └── project_rules.md    # 本规则文件
├── docs/
│   ├── PROJECT_CONTEXT.md      # 项目全局上下文（每次必读）
│   ├── SPEC.md                 # 详细规格说明
│   ├── TASK_LIST.md            # 任务清单
│   └── PROGRESS.md             # 进度记录
└── src/                        # 代码目录
```

### 1.2 初始化 PROJECT_CONTEXT.md

创建 `docs/PROJECT_CONTEXT.md`：

```markdown
# 项目全局上下文

## 项目概述
- 项目名称：
- 当前阶段：初始化
- 技术栈：
- 项目描述：

## 已完成模块
（开发过程中实时更新）

| 模块 | 文件路径 | 状态 |
|------|---------|------|
| | | |

## 路由配置

| 路径 | 组件 | 状态 |
|------|------|------|
| | | |

## 数据模型

（记录主要数据结构）

## 当前任务
- [ ]

## 下一步计划
- [ ]
```

---

## 二、开发流程

### 2.1 每次开发新功能前

1. **读取 PROJECT_CONTEXT.md**
   - 了解项目当前状态
   - 知道已有哪些页面/组件
   - 知道路由配置和数据模型

2. **明确本次任务**
   - 查看 TASK_LIST.md
   - 确认要做的功能

### 2.2 代码生成时

1. **提供完整上下文**
   - 告知AI已有模块
   - 告知AI数据模型
   - 告知AI路由配置

2. **参考示例**

   ```
   "根据 PROJECT_CONTEXT.md，项目当前状态如下：
   - 已完成：登录页、首页
   - 已有路由：/login、/home
   - 数据模型：User { id, name, email }
   
   现在需要生成用户详情页 /src/pages/UserDetail.tsx，要求：..."
   ```

### 2.3 代码生成后

1. **更新 PROJECT_CONTEXT.md**
   - 添加新完成的模块
   - 更新路由配置
   - 更新数据模型（如有新字段）

2. **更新 TASK_LIST.md**
   - 标记已完成的任务

3. **更新 PROGRESS.md**
   - 记录本次完成的工作

---

## 三、验收检查清单

每次代码生成完成后，必须对照检查：

### 3.1 功能完整性
- [ ] 所有需求功能都实现了？
- [ ] 边界情况处理了？

### 3.2 代码质量
- [ ] 代码风格一致？
- [ ] 类型定义完整？
- [ ] 错误处理有了？

### 3.3 集成正确性
- [ ] 路由配置正确？
- [ ] 页面跳转关系对？
- [ ] 数据流对？
- [ ] 与现有模块兼容？

---

## 四、业务逻辑思考框架

### 4.1 开发新功能时，先问自己3个问题

| 问题 | 含义 |
|-----|------|
| 给谁用？ | 角色：谁可以看、谁可以操作 |
| 做什么？ | 操作：用户点哪里、做什么、做完显示什么 |
| 存什么？ | 数据：需要存哪些字段、字段之间什么关系 |

### 4.2 示例：评论功能

| 问题 | 回答 |
|-----|------|
| 给谁用？ | 买家评论、卖家回复、管理员删除 |
|做什么？ | 写评论→提交→显示在商品详情 |
|存什么？ | 评论内容、商品ID、用户ID、时间、状态 |

---

## 五、提示词模板

### 5.1 生成新页面

```markdown
根据 PROJECT_CONTEXT.md 的项目状态，生成 [页面名称]。

## 已有信息
- 已完成模块：[列表]
- 路由配置：[列表]
- 数据模型：[列表]

## 本次任务
- 页面路径：
- 核心功能：
- 交互流程：

## 要求
- 风格与现有代码一致
- 使用已有的组件库
- 包含基本的错误处理
```

### 5.2 生成API

```markdown
根据 PROJECT_CONTEXT.md，生成 [API名称]。

## 已有信息
- 数据模型：[列表]
- 现有API：[列表]

## 本次任务
- API路径：
- 请求方法：
- 请求参数：
- 响应格式：

## 要求
- 遵循RESTful规范
- 包含错误处理
- 与现有接口风格一致
```

---

## 六、迭代原则

### 6.1 核心理念
- **先完成，再完美**
- **小步快跑，快速迭代**
- **文档和框架是工具，不是目的**

### 6.2 迭代流程
```
AI生成代码 → 人工审核 → 发现问题 → 让AI修改 → 测试 → 下一轮
```

---

## 七、常见问题处理

### 7.1 AI漏功能怎么办？
- 检查 PROJECT_CONTEXT.md 是否及时更新
- 每次生成时明确告知已有模块清单
- 使用验收清单逐项检查

### 7.2 业务逻辑想不清楚怎么办？
- 用3问法：给谁用、做什么、存什么
- 先做最小版本，有问题再迭代
- 不确定的地方先空着，做的时候再明确

### 7.3 上下文丢失怎么办？
- 始终保持 PROJECT_CONTEXT.md 是最新状态
- 每次新对话先读取这个文件
- 重要的设计决策都记录在里面

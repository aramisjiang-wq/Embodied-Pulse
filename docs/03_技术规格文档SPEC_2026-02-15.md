# Embodied Pulse 技术规格文档（SPEC）

**产品名称**：Embodied Pulse（具身智能脉搏）  
**文档类型**：技术规格说明书  
**版本**：v5.1  
**更新日期**：2026-02-15  
**状态**：已审核  

---

## 目录

1. [系统架构图谱](#1-系统架构图谱)
2. [技术栈规格](#2-技术栈规格)
3. [数据库设计规格](#3-数据库设计规格)
4. [API 接口规格](#4-api-接口规格)
5. [前端组件规格](#5-前端组件规格)
6. [第三方服务规格](#6-第三方服务规格)
7. [部署架构规格](#7-部署架构规格)
8. [安全规格](#8-安全规格)

---

## 1. 系统架构图谱

### 1.1 整体架构图

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              客户端层 (Client Layer)                          │
├─────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐         │
│  │   Web Browser   │    │   Mobile PWA    │    │   Admin Panel   │         │
│  │   (Next.js 14)  │    │   (Responsive)  │    │   (Next.js 14)  │         │
│  └────────┬────────┘    └────────┬────────┘    └────────┬────────┘         │
│           │                      │                      │                   │
│           └──────────────────────┼──────────────────────┘                   │
│                                  ▼                                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                              网关层 (Gateway Layer)                          │
├─────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                    NGINX 反向代理 + 负载均衡                          │   │
│  │                    - SSL 终端 / 静态资源 / 请求转发                    │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                  │                                          │
│                                  ▼                                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                              服务层 (Service Layer)                          │
├─────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                    Backend API (Express + TypeScript)                │   │
│  │  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐  │   │
│  │  │ 认证服务  │ │ 内容服务  │ │ 社区服务  │ │ 同步服务  │ │ 管理服务  │  │   │
│  │  │  Auth    │ │ Content  │ │Community │ │  Sync    │ │  Admin   │  │   │
│  │  └──────────┘ └──────────┘ └──────────┘ └──────────┘ └──────────┘  │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                  │                                          │
│                                  ▼                                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                              数据层 (Data Layer)                             │
├─────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐         │
│  │   SQLite/PG     │    │     Redis       │    │  File Storage   │         │
│  │   (主数据库)     │    │  (缓存/队列)     │    │   (文件存储)     │         │
│  │   Prisma ORM    │    │   Bull Queue    │    │                 │         │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘         │
│                                                                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                           外部服务层 (External Services)                     │
├─────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐  │
│  │ ArXiv   │ │ GitHub  │ │Bilibili │ │HuggingFace│ │  36kr  │ │ YouTube │  │
│  │  API    │ │  API    │ │  API    │ │   API    │ │  API   │ │  API    │  │
│  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘  │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 1.2 前端架构图

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              前端架构                                         │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                         页面层 (Pages)                               │   │
│  │  ┌───────────┐ ┌───────────┐ ┌───────────┐ ┌───────────┐          │   │
│  │  │ 首页      │ │ 内容页    │ │ 社区页    │ │ 管理页    │          │   │
│  │  │ /         │ │ /papers   │ │/community │ │ /admin    │          │   │
│  │  │ /videos   │ │ /repos    │ │ /posts    │ │ /users    │          │   │
│  │  └───────────┘ └───────────┘ └───────────┘ └───────────┘          │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                   │                                         │
│                                   ▼                                         │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                         组件层 (Components)                          │   │
│  │  ┌───────────┐ ┌───────────┐ ┌───────────┐ ┌───────────┐          │   │
│  │  │ Layout    │ │ Feed      │ │ Content   │ │ Common    │          │   │
│  │  │ Header    │ │ FeedCard  │ │ PaperCard │ │ Button    │          │   │
│  │  │ Sidebar   │ │ FeedList  │ │ VideoCard │ │ Modal     │          │   │
│  │  │ Footer    │ │ FilterBar │ │ RepoCard  │ │ Table     │          │   │
│  │  └───────────┘ └───────────┘ └───────────┘ └───────────┘          │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                   │                                         │
│                                   ▼                                         │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                         状态层 (State)                               │   │
│  │  ┌───────────────────────┐ ┌───────────────────────┐               │   │
│  │  │  React Query          │ │  Zustand              │               │   │
│  │  │  - 服务端状态缓存      │ │  - 客户端状态管理      │               │   │
│  │  │  - 数据获取和同步      │ │  - 用户认证状态        │               │   │
│  │  │  - 缓存失效策略        │ │  - UI状态管理          │               │   │
│  │  └───────────────────────┘ └───────────────────────┘               │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                   │                                         │
│                                   ▼                                         │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                         API层 (API Client)                           │   │
│  │  ┌───────────────────────────────────────────────────────────────┐ │   │
│  │  │  Axios Instance                                                │ │   │
│  │  │  - 请求拦截器 (添加Token)                                       │ │   │
│  │  │  - 响应拦截器 (错误处理)                                        │ │   │
│  │  │  - 自动刷新Token                                                │ │   │
│  │  └───────────────────────────────────────────────────────────────┘ │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 1.3 后端架构图

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              后端架构                                         │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                         入口层 (Entry)                               │   │
│  │  ┌───────────────────────────────────────────────────────────────┐ │   │
│  │  │  Express App                                                   │ │   │
│  │  │  - CORS配置                                                    │ │   │
│  │  │  - Body Parser                                                 │ │   │
│  │  │  - 日志中间件                                                  │ │   │
│  │  │  - 错误处理中间件                                              │ │   │
│  │  └───────────────────────────────────────────────────────────────┘ │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                   │                                         │
│                                   ▼                                         │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                         中间件层 (Middleware)                        │   │
│  │  ┌───────────┐ ┌───────────┐ ┌───────────┐ ┌───────────┐          │   │
│  │  │ Auth      │ │ Validate  │ │ RateLimit │ │ Admin     │          │   │
│  │  │ JWT验证   │ │ 输入验证  │ │ 请求限流  │ │ 管理员权限 │          │   │
│  │  └───────────┘ └───────────┘ └───────────┘ └───────────┘          │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                   │                                         │
│                                   ▼                                         │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                         路由层 (Routes)                              │   │
│  │  ┌───────────┐ ┌───────────┐ ┌───────────┐ ┌───────────┐          │   │
│  │  │ /auth     │ │ /papers   │ │ /videos   │ │ /admin    │          │   │
│  │  │ /users    │ │ /repos    │ │ /posts    │ │ /sync     │          │   │
│  │  │ /favorites│ │ /jobs     │ │ /comments │ │ /stats    │          │   │
│  │  └───────────┘ └───────────┘ └───────────┘ └───────────┘          │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                   │                                         │
│                                   ▼                                         │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                         控制层 (Controllers)                         │   │
│  │  ┌───────────┐ ┌───────────┐ ┌───────────┐ ┌───────────┐          │   │
│  │  │ AuthCtrl  │ │ PaperCtrl │ │ VideoCtrl │ │ AdminCtrl │          │   │
│  │  │ UserCtrl  │ │ RepoCtrl  │ │ PostCtrl  │ │ SyncCtrl  │          │   │
│  │  └───────────┘ └───────────┘ └───────────┘ └───────────┘          │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                   │                                         │
│                                   ▼                                         │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                         服务层 (Services)                            │   │
│  │  ┌───────────┐ ┌───────────┐ ┌───────────┐ ┌───────────┐          │   │
│  │  │ AuthService│ │PaperService│ │VideoService│ │SyncService│          │   │
│  │  │ UserService│ │ RepoService│ │ PostService│ │CacheService│          │   │
│  │  └───────────┘ └───────────┘ └───────────┘ └───────────┘          │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                   │                                         │
│                                   ▼                                         │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                         数据层 (Data)                                │   │
│  │  ┌───────────────────────┐ ┌───────────────────────┐               │   │
│  │  │  Prisma ORM           │ │  Redis Client         │               │   │
│  │  │  - 数据库操作          │ │  - 缓存读写            │               │   │
│  │  │  - 事务管理            │ │  - 队列管理            │               │   │
│  │  │  - 关联查询            │ │  - 会话存储            │               │   │
│  │  └───────────────────────┘ └───────────────────────┘               │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 2. 技术栈规格

### 2.1 前端技术栈

| 技术 | 版本 | 用途 | 备注 |
|------|------|------|------|
| Next.js | 14.2.x | React 框架 | App Router 架构 |
| TypeScript | 5.3.x | 类型安全 | 严格模式启用 |
| React | 18.2.x | UI 库 | - |
| Ant Design | 5.12.x | UI 组件库 | 主题定制 |
| @tanstack/react-query | 5.28.x | 数据获取 | 缓存管理 |
| Zustand | 4.5.x | 状态管理 | 轻量级 |
| Axios | 1.6.x | HTTP 客户端 | 拦截器配置 |
| Recharts | 2.10.x | 图表库 | 数据可视化 |
| Tailwind CSS | 3.4.x | CSS 框架 | 响应式样式 |
| Day.js | 1.11.x | 日期处理 | 轻量级 moment |

### 2.2 后端技术栈

| 技术 | 版本 | 用途 | 备注 |
|------|------|------|------|
| Node.js | 20.x | 运行环境 | LTS 版本 |
| Express | 4.18.x | Web 框架 | 中间件架构 |
| TypeScript | 5.3.x | 类型安全 | 严格模式 |
| Prisma ORM | 5.9.x | 数据库 ORM | 双 schema |
| SQLite | 3.44.x | 开发数据库 | 文件数据库 |
| PostgreSQL | 15.x | 生产数据库 | 关系型 |
| Redis | 7.x | 缓存/队列 | 内存数据库 |
| JWT | 9.0.x | 身份认证 | 双Token机制 |
| bcryptjs | 2.4.x | 密码加密 | - |
| Bull | 4.12.x | 任务队列 | 基于 Redis |
| node-cron | 4.2.x | 定时任务 | - |
| Zod | 3.22.x | 数据验证 | Schema 验证 |

### 2.3 开发工具规格

| 工具 | 用途 | 配置文件 |
|------|------|----------|
| ESLint | 代码规范检查 | .eslintrc.json |
| Prettier | 代码格式化 | .prettierrc |
| Husky | Git Hooks | lint-staged |
| ts-node | TypeScript 执行 | tsconfig.json |

---

## 3. 数据库设计规格

### 3.1 核心数据表

#### 3.1.1 用户表 (users)

| 字段名 | 类型 | 约束 | 说明 |
|--------|------|------|------|
| id | STRING(36) | PK | UUID 主键 |
| email | STRING(255) | UK, NOT NULL | 邮箱唯一 |
| password_hash | STRING(255) | NOT NULL | 加密密码 |
| nickname | STRING(50) | NOT NULL | 昵称 |
| avatar_url | STRING(500) | NULL | 头像 URL |
| bio | TEXT | NULL | 个人简介 |
| points | INT | DEFAULT 0 | 积分 |
| role | STRING(20) | DEFAULT 'user' | 角色 |
| status | STRING(20) | DEFAULT 'active' | 状态 |
| created_at | DATETIME | DEFAULT now() | 创建时间 |
| updated_at | DATETIME | - | 更新时间 |

#### 3.1.2 论文表 (papers)

| 字段名 | 类型 | 约束 | 说明 |
|--------|------|------|------|
| id | STRING(36) | PK | UUID 主键 |
| arxiv_id | STRING(50) | UK | ArXiv ID |
| title | TEXT | NOT NULL | 论文标题 |
| abstract | TEXT | NULL | 摘要 |
| authors | TEXT | NOT NULL | 作者 JSON |
| pdf_url | STRING(500) | NULL | PDF 链接 |
| published_date | DATETIME | NOT NULL | 发表日期 |
| categories | TEXT | NULL | 分类 JSON |
| view_count | INT | DEFAULT 0 | 浏览数 |
| favorite_count | INT | DEFAULT 0 | 收藏数 |
| citation_count | INT | DEFAULT 0 | 引用数 |

#### 3.1.3 视频表 (videos)

| 字段名 | 类型 | 约束 | 说明 |
|--------|------|------|------|
| id | STRING(36) | PK | UUID 主键 |
| bvid | STRING(20) | UK | B站视频 ID |
| title | TEXT | NOT NULL | 视频标题 |
| description | TEXT | NULL | 描述 |
| cover_url | STRING(500) | NULL | 封面图 |
| duration | INT | NULL | 时长(秒) |
| view_count | INT | DEFAULT 0 | 播放数 |
| danmaku_count | INT | DEFAULT 0 | 弹幕数 |
| uploader_mid | BIGINT | NOT NULL | UP主 ID |
| uploader_name | STRING(100) | NOT NULL | UP主名 |
| publish_time | DATETIME | NOT NULL | 发布时间 |

#### 3.1.4 仓库表 (github_repos)

| 字段名 | 类型 | 约束 | 说明 |
|--------|------|------|------|
| id | STRING(36) | PK | UUID 主键 |
| github_id | INT | UK | GitHub ID |
| owner | STRING(100) | NOT NULL | 仓库所有者 |
| name | STRING(100) | NOT NULL | 仓库名 |
| full_name | STRING(200) | UK | 完整名称 |
| description | TEXT | NULL | 描述 |
| star_count | INT | DEFAULT 0 | 星标数 |
| fork_count | INT | DEFAULT 0 | Fork 数 |
| language | STRING(50) | NULL | 主要语言 |
| readme_url | STRING(500) | NULL | README URL |

#### 3.1.5 社区帖子表 (posts)

| 字段名 | 类型 | 约束 | 说明 |
|--------|------|------|------|
| id | STRING(36) | PK | UUID 主键 |
| user_id | STRING(36) | FK, NOT NULL | 作者 ID |
| content_type | STRING(50) | NULL | 关联内容类型 |
| content_id | STRING(36) | NULL | 关联内容 ID |
| title | STRING(200) | NULL | 帖子标题 |
| content | TEXT | NOT NULL | 正文 |
| tags | TEXT | NULL | 标签 JSON |
| view_count | INT | DEFAULT 0 | 浏览数 |
| like_count | INT | DEFAULT 0 | 点赞数 |
| comment_count | INT | DEFAULT 0 | 评论数 |
| status | STRING(20) | DEFAULT 'active' | 状态 |

#### 3.1.6 邮箱验证表 (email_verifications)

| 字段名 | 类型 | 约束 | 说明 |
|--------|------|------|------|
| id | STRING(36) | PK | UUID 主键 |
| email | STRING(255) | NOT NULL | 邮箱地址 |
| code | STRING(6) | NOT NULL | 6位验证码 |
| type | STRING(20) | NOT NULL | 类型（register/reset） |
| expires_at | DATETIME | NOT NULL | 过期时间 |
| used | BOOLEAN | DEFAULT FALSE | 是否已使用 |
| created_at | DATETIME | DEFAULT now() | 创建时间 |

#### 3.1.7 密码重置表 (password_resets)

| 字段名 | 类型 | 约束 | 说明 |
|--------|------|------|------|
| id | STRING(36) | PK | UUID 主键 |
| email | STRING(255) | NOT NULL | 邮箱地址 |
| token | STRING(64) | UK | 重置令牌 |
| expires_at | DATETIME | NOT NULL | 过期时间 |
| used | BOOLEAN | DEFAULT FALSE | 是否已使用 |
| created_at | DATETIME | DEFAULT now() | 创建时间 |

#### 3.1.8 自定义页面表 (custom_pages)

| 字段名 | 类型 | 约束 | 说明 |
|--------|------|------|------|
| id | STRING(36) | PK | UUID 主键 |
| title | STRING(200) | NOT NULL | 页面标题 |
| slug | STRING(100) | UK | URL 标识 |
| content | TEXT | NOT NULL | 页面内容（HTML） |
| is_active | BOOLEAN | DEFAULT TRUE | 是否启用 |
| sort_order | INT | DEFAULT 0 | 排序 |
| created_at | DATETIME | DEFAULT now() | 创建时间 |
| updated_at | DATETIME | - | 更新时间 |

### 3.2 索引设计

| 表名 | 索引字段 | 类型 | 说明 |
|------|----------|------|------|
| papers | published_date | DESC | 按时间排序 |
| papers | view_count | DESC | 热度排序 |
| videos | publish_time | DESC | 时间排序 |
| videos | view_count | DESC | 热度排序 |
| github_repos | star_count | DESC | 热度排序 |
| posts | user_id | - | 用户查询 |
| posts | created_at | DESC | 时间排序 |
| comments | post_id | - | 帖子查询 |
| favorites | user_id | - | 用户查询 |
| email_verifications | email | - | 邮箱查询 |
| email_verifications | code | - | 验证码查询 |
| password_resets | email | - | 邮箱查询 |
| password_resets | token | UK | 令牌查询 |
| custom_pages | slug | UK | slug 查询 |

---

## 4. API 接口规格

### 4.1 统一响应格式

```typescript
interface ApiResponse<T> {
  code: number;      // 状态码：0=成功
  message: string;   // 状态消息
  data: T;           // 响应数据
  timestamp: number; // 时间戳
}

interface PaginatedResponse<T> {
  items: T[];
  pagination: {
    page: number;
    size: number;
    total: number;
    totalPages: number;
    hasNext: boolean;
    hasPrev: boolean;
  };
}
```

### 4.2 错误码规格

| 错误码 | 说明 | HTTP 状态码 |
|--------|------|-------------|
| 0 | 成功 | 200 |
| 1001 | 参数错误 | 400 |
| 1002 | 未提供 Token | 401 |
| 1003 | Token 无效 | 401 |
| 2001 | 资源不存在 | 404 |
| 2002 | 权限不足 | 403 |
| 3001 | 服务器内部错误 | 500 |

### 4.3 核心 API 接口

#### 4.3.1 认证接口

| 方法 | 路径 | 说明 | 认证 |
|------|------|------|------|
| POST | /api/auth/register | 用户注册（含邮箱验证） | 否 |
| POST | /api/auth/login | 账号密码登录 | 否 |
| POST | /api/auth/logout | 退出登录 | 是 |
| POST | /api/auth/refresh | 刷新 Token | 否 |
| GET | /api/auth/profile | 获取个人信息 | 是 |
| POST | /api/email-verification/send | 发送邮箱验证码 | 否 |
| POST | /api/email-verification/verify | 验证邮箱验证码 | 否 |
| POST | /api/password-reset/request | 请求密码重置 | 否 |
| POST | /api/password-reset/confirm | 确认密码重置 | 否 |

#### 4.3.2 内容接口

| 方法 | 路径 | 说明 | 认证 |
|------|------|------|------|
| GET | /api/papers | 论文列表 | 否 |
| GET | /api/papers/:id | 论文详情 | 否 |
| GET | /api/videos | 视频列表 | 否 |
| GET | /api/videos/:id | 视频详情 | 否 |
| GET | /api/repos | 仓库列表 | 否 |
| GET | /api/repos/:id | 仓库详情 | 否 |
| GET | /api/huggingface | 模型列表 | 否 |
| GET | /api/news | 新闻列表 | 否 |
| GET | /api/jobs | 职位列表 | 否 |

#### 4.3.3 用户接口

| 方法 | 路径 | 说明 | 认证 |
|------|------|------|------|
| GET | /api/favorites | 收藏列表 | 是 |
| POST | /api/favorites | 添加收藏 | 是 |
| DELETE | /api/favorites/:id | 取消收藏 | 是 |
| GET | /api/subscriptions | 订阅列表 | 是 |
| POST | /api/subscriptions | 创建订阅 | 是 |
| DELETE | /api/subscriptions/:id | 取消订阅 | 是 |

#### 4.3.4 管理接口

| 方法 | 路径 | 说明 | 权限 |
|------|------|------|------|
| GET | /api/admin/users | 用户列表 | admin |
| PUT | /api/admin/users/:id | 更新用户 | admin |
| GET | /api/admin/content/papers | 论文管理 | admin |
| POST | /api/admin/sync/all | 全部同步 | admin |
| GET | /api/admin/sync/status | 同步状态 | admin |
| GET | /api/admin/pages | 自定义页面列表 | admin |
| POST | /api/admin/pages | 创建自定义页面 | admin |
| PUT | /api/admin/pages/:id | 更新自定义页面 | admin |
| DELETE | /api/admin/pages/:id | 删除自定义页面 | admin |

#### 4.3.5 自定义页面接口

| 方法 | 路径 | 说明 | 认证 |
|------|------|------|------|
| GET | /api/pages | 获取启用的页面列表 | 否 |
| GET | /api/pages/slug/:slug | 根据 slug 获取页面 | 否 |

### 4.4 Token 认证规格

#### 4.4.1 Token 结构

```typescript
interface JWTPayload {
  userId: string;
  role: string;
  iat: number;
  exp: number;
}
```

#### 4.4.2 Token 有效期

| Token 类型 | 有效期 | 用途 |
|------------|--------|------|
| Access Token | 7 天 | API 调用 |
| Refresh Token | 30 天 | 刷新 Token |

#### 4.4.3 密钥配置

```env
JWT_ACCESS_SECRET=your_access_secret_key
JWT_REFRESH_SECRET=your_refresh_secret_key
```

---

## 5. 前端组件规格

### 5.1 页面路由规格

| 路径 | 页面 | 说明 |
|------|------|------|
| / | 首页 | 信息流展示 |
| /papers | 论文列表 | 论文卡片列表 |
| /papers/[id] | 论文详情 | 论文详情 |
| /videos | 视频列表 | 视频卡片列表 |
| /videos/[id] | 视频详情 | 播放器页 |
| /repos | 仓库列表 | 仓库卡片列表 |
| /repos/[id] | 仓库详情 | 仓库详情 |
| /huggingface | 模型列表 | 模型卡片列表 |
| /community | 社区 | 帖子列表 |
| /community/[id] | 帖子详情 | 帖子详情 |
| /profile | 个人中心 | 用户资料 |
| /favorites | 收藏 | 收藏列表 |
| /subscriptions | 订阅 | 订阅列表 |
| /login | 登录 | 邮箱密码登录 |
| /register | 注册 | 邮箱验证码注册 |
| /forgot-password | 忘记密码 | 密码找回 |
| /reset-password | 重置密码 | 密码重置 |
| /page/[slug] | 自定义页面 | 管理员创建的页面 |
| /admin | 管理端 | 数据概览 |
| /admin/pages | 页面管理 | 自定义页面管理 |

### 5.2 状态管理规格

#### 5.2.1 React Query 配置

```typescript
const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      staleTime: 5 * 60 * 1000,
      cacheTime: 30 * 60 * 1000,
      retry: 1,
      refetchOnWindowFocus: false,
    },
  },
});
```

#### 5.2.2 Zustand Store 结构

```typescript
interface AuthState {
  user: User | null;
  token: string | null;
  isAuthenticated: boolean;
  isAdmin: boolean;
  hydrated: boolean;
  
  setUser: (user: User | null) => void;
  setToken: (token: string | null, isAdmin?: boolean) => void;
  logout: () => void;
  initialize: () => void;
}
```

### 5.3 API 客户端规格

```typescript
const api = axios.create({
  baseURL: process.env.NEXT_PUBLIC_API_URL,
  timeout: 30000,
  headers: { 'Content-Type': 'application/json' },
});

api.interceptors.request.use((config) => {
  const token = getToken();
  if (token) {
    config.headers.Authorization = `Bearer ${token}`;
  }
  return config;
});

api.interceptors.response.use(
  (response) => response.data,
  (error) => {
    if (error.response?.status === 401) {
      logout();
      router.push('/login');
    }
    return Promise.reject(error);
  }
);
```

---

## 6. 第三方服务规格

### 6.1 外部 API 集成

| 服务 | API | 用途 | 频率限制 |
|------|-----|------|----------|
| GitHub | REST API | 仓库同步 | 5000次/小时 |
| ArXiv | API | 论文同步 | 无限制 |
| Bilibili | API | 视频同步 | 需登录态 |
| HuggingFace | API | 模型同步 | 无限制 |
| 36kr | 爬虫 | 新闻同步 | 需控制频率 |

### 6.2 同步任务配置

| 任务 | 频率 | 说明 |
|------|------|------|
| ArXiv 论文同步 | 每小时 | 增量同步 |
| GitHub 仓库同步 | 每15分钟 | 热门仓库 |
| Bilibili 视频同步 | 每小时 | UP主视频 |
| HuggingFace 模型同步 | 每6小时 | 热门模型 |
| 新闻同步 | 每30分钟 | 增量同步 |

---

## 7. 部署架构规格

### 7.1 环境配置

| 环境 | 域名 | 数据库 | 说明 |
|------|------|------|------|
| 开发 | localhost | SQLite | 本地开发 |
| 测试 | test.example.com | PostgreSQL | 测试环境 |
| 生产 | www.example.com | PostgreSQL | 生产环境 |

### 7.2 服务配置

| 服务 | 端口 | 说明 |
|------|------|------|
| Frontend | 3000 | Next.js |
| Backend | 3001 | Express |
| Redis | 6379 | 缓存服务 |
| PostgreSQL | 5432 | 数据库 |

### 7.3 环境变量

```env
DATABASE_URL=postgresql://user:pass@host:5432/db
REDIS_URL=redis://localhost:6379
JWT_ACCESS_SECRET=your_secret
JWT_REFRESH_SECRET=your_refresh_secret
GITHUB_TOKEN=your_github_token
```

---

## 8. 安全规格

### 8.1 认证安全

| 项目 | 规格 | 状态 |
|------|------|------|
| 密码加密 | bcrypt (10 rounds) | ✅ |
| JWT双Token | Access + Refresh | ✅ |
| Token刷新 | 自动刷新机制 | ✅ |
| 会话管理 | Redis存储 | ✅ |

### 8.2 接口安全

| 项目 | 规格 | 状态 |
|------|------|------|
| 输入验证 | Zod Schema | ✅ |
| XSS防护 | DOMPurify | ✅ |
| SQL注入防护 | Prisma ORM | ✅ |
| CORS配置 | 白名单域名 | ✅ |
| 请求限流 | express-rate-limit | ✅ |

### 8.3 数据安全

| 项目 | 规格 | 状态 |
|------|------|------|
| 敏感数据加密 | 环境变量 | ✅ |
| 数据库备份 | 每日自动备份 | ✅ |
| 日志脱敏 | 敏感信息过滤 | ✅ |

---

## 附录

### A. 技术债务清单

| 项目 | 描述 | 优先级 | 状态 |
|------|------|--------|------|
| Hydration错误 | 前端服务端/客户端渲染不一致 | 高 | 进行中 |
| 测试覆盖率 | 单元测试和集成测试不足 | 中 | 待开始 |
| API文档 | 缺少完整的API文档 | 中 | 待开始 |
| 性能优化 | 首屏加载速度优化 | 中 | 待开始 |

### B. 性能指标

| 指标 | 目标值 | 当前值 | 状态 |
|------|--------|--------|------|
| 首屏加载 (FCP) | < 1.5s | ~2s | ⚠️ |
| 最大内容绘制 (LCP) | < 2.5s | ~3s | ⚠️ |
| 累积布局偏移 (CLS) | < 0.1 | ~0.05 | ✅ |
| 首次输入延迟 (FID) | < 100ms | ~50ms | ✅ |
| API响应 (P95) | < 500ms | ~300ms | ✅ |

---

**文档维护**：本文档应随系统演进持续更新。如有疑问或建议，请联系技术团队。
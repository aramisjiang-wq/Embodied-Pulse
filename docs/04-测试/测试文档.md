# Embodied Pulse 测试文档

**产品名称**：Embodied Pulse（具身智能脉搏）  
**文档类型**：测试指南  
**版本**：v2.0  
**更新日期**：2026-02-17  
**适用对象**：测试人员、开发者  

---

## 目录

1. [测试概述](#1-测试概述)
2. [测试环境](#2-测试环境)
3. [测试账号](#3-测试账号)
4. [功能测试用例](#4-功能测试用例)
5. [API测试](#5-api测试)
6. [自动化测试](#6-自动化测试)
7. [性能测试](#7-性能测试)
8. [安全测试](#8-安全测试)

---

## 1. 测试概述

### 1.1 测试范围

| 模块 | 测试类型 | 优先级 |
|------|----------|--------|
| 用户认证 | 功能测试、安全测试 | P0 |
| 内容浏览 | 功能测试、性能测试 | P0 |
| 社区功能 | 功能测试 | P1 |
| 管理后台 | 功能测试 | P1 |
| 数据同步 | 功能测试、性能测试 | P2 |

### 1.2 测试策略

- **单元测试**：核心业务逻辑
- **集成测试**：API接口测试
- **E2E测试**：关键用户流程
- **性能测试**：接口响应时间、并发处理
- **安全测试**：认证授权、输入验证

### 1.3 测试框架

| 项目 | 前端 | 后端 |
|------|------|------|
| 测试框架 | Jest | Vitest |
| 测试工具 | @testing-library/react | supertest |
| 覆盖率工具 | jest --coverage | vitest --coverage |
| E2E测试 | - | - |

---

## 2. 测试环境

### 2.1 环境配置

| 项目 | 配置 |
|------|------|
| Node.js | 20.x |
| 数据库(开发) | SQLite 3.44.x |
| 数据库(生产) | PostgreSQL 15.x |
| 缓存 | Redis 7.x |

### 2.2 启动测试环境

```bash
# 启动后端
cd backend
npm run dev

# 启动前端
cd frontend
npm run dev
```

### 2.3 初始化测试数据

```bash
cd backend
npm run db:seed
```

---

## 3. 测试账号

### 3.1 用户端测试账号

| 账号类型 | 用户名 | 邮箱 | 密码 | 说明 |
|----------|--------|------|------|------|
| 测试用户 | testuser | test@example.com | password123 | 测试账号 |

### 3.2 管理端测试账号

| 账号类型 | 用户名 | 邮箱 | 密码 | 说明 |
|----------|--------|------|------|------|
| 超级管理员 | limx | limx-admin@embodiedpulse.com | limx123456 | 超级管理员 (level: 10) |

---

## 4. 功能测试用例

### 4.1 用户认证模块

#### TC-AUTH-001: 用户注册（正常流程）

| 项目 | 内容 |
|------|------|
| 用例ID | TC-AUTH-001 |
| 前置条件 | 用户未注册 |
| 测试步骤 | 1. 访问 http://localhost:3000/register<br>2. 输入邮箱<br>3. 点击发送验证码<br>4. 输入验证码<br>5. 设置密码和昵称<br>6. 点击注册 |
| 预期结果 | 注册成功，自动登录，跳转首页 |
| 测试数据 | 邮箱: newuser@test.com, 密码: Test123456 |

#### TC-AUTH-002: 用户注册（邮箱已存在）

| 项目 | 内容 |
|------|------|
| 用例ID | TC-AUTH-002 |
| 前置条件 | 邮箱已注册 |
| 测试步骤 | 1. 访问 http://localhost:3000/register<br>2. 输入已注册邮箱: test@example.com<br>3. 点击发送验证码 |
| 预期结果 | 提示邮箱已被注册 |

#### TC-AUTH-003: 用户登录（正常流程）

| 项目 | 内容 |
|------|------|
| 用例ID | TC-AUTH-003 |
| 前置条件 | 用户已注册 |
| 测试步骤 | 1. 访问 http://localhost:3000/login<br>2. 输入邮箱: test@example.com<br>3. 输入密码: password123<br>4. 点击登录 |
| 预期结果 | 登录成功，跳转首页，显示用户信息 |

#### TC-AUTH-004: 用户登录（密码错误）

| 项目 | 内容 |
|------|------|
| 用例ID | TC-AUTH-004 |
| 前置条件 | 用户已注册 |
| 测试步骤 | 1. 访问 http://localhost:3000/login<br>2. 输入邮箱: test@example.com<br>3. 输入错误密码: wrongpassword<br>4. 点击登录 |
| 预期结果 | 提示邮箱或密码错误 |

#### TC-AUTH-005: 密码找回

| 项目 | 内容 |
|------|------|
| 用例ID | TC-AUTH-005 |
| 前置条件 | 用户已注册 |
| 测试步骤 | 1. 访问 http://localhost:3000/forgot-password<br>2. 输入邮箱<br>3. 点击发送重置邮件<br>4. 查收邮件<br>5. 点击重置链接<br>6. 设置新密码 |
| 预期结果 | 密码重置成功，可使用新密码登录 |

#### TC-AUTH-006: 管理员登录

| 项目 | 内容 |
|------|------|
| 用例ID | TC-AUTH-006 |
| 前置条件 | 管理员账号存在 |
| 测试步骤 | 1. 访问 http://localhost:3000/admin/login<br>2. 输入邮箱: limx-admin@embodiedpulse.com<br>3. 输入密码: limx123456<br>4. 点击登录 |
| 预期结果 | 登录成功，跳转管理后台首页 |

### 4.2 内容浏览模块

#### TC-CONTENT-001: 首页信息流加载

| 项目 | 内容 |
|------|------|
| 用例ID | TC-CONTENT-001 |
| 前置条件 | 无 |
| 测试步骤 | 1. 访问 http://localhost:3000<br>2. 观察内容加载<br>3. 滚动页面加载更多 |
| 预期结果 | 信息流正常加载，显示多种类型内容，无限滚动正常 |

#### TC-CONTENT-002: 论文列表浏览

| 项目 | 内容 |
|------|------|
| 用例ID | TC-CONTENT-002 |
| 前置条件 | 无 |
| 测试步骤 | 1. 访问 http://localhost:3000/papers<br>2. 滚动加载更多<br>3. 点击论文卡片进入详情 |
| 预期结果 | 列表正常加载，详情页正常显示论文信息 |

#### TC-CONTENT-003: 视频列表浏览

| 项目 | 内容 |
|------|------|
| 用例ID | TC-CONTENT-003 |
| 前置条件 | 无 |
| 测试步骤 | 1. 访问 http://localhost:3000/videos<br>2. 滚动加载更多<br>3. 点击视频卡片进入详情 |
| 预期结果 | 列表正常加载，详情页视频播放正常 |

#### TC-CONTENT-004: 搜索功能

| 项目 | 内容 |
|------|------|
| 用例ID | TC-CONTENT-004 |
| 前置条件 | 无 |
| 测试步骤 | 1. 在首页搜索框输入关键词<br>2. 点击搜索<br>3. 查看搜索结果 |
| 预期结果 | 搜索结果正确显示相关内容 |

### 4.3 社区功能模块

#### TC-COMMUNITY-001: 发布帖子

| 项目 | 内容 |
|------|------|
| 用例ID | TC-COMMUNITY-001 |
| 前置条件 | 用户已登录 |
| 测试步骤 | 1. 访问 http://localhost:3000/my-community<br>2. 点击发布帖子<br>3. 填写标题和内容<br>4. 点击发布 |
| 预期结果 | 帖子发布成功，显示在列表中 |

#### TC-COMMUNITY-002: 评论功能

| 项目 | 内容 |
|------|------|
| 用例ID | TC-COMMUNITY-002 |
| 前置条件 | 用户已登录，存在帖子 |
| 测试步骤 | 1. 访问帖子详情页<br>2. 输入评论内容<br>3. 点击发送 |
| 预期结果 | 评论发送成功，显示在评论列表 |

### 4.4 用户功能模块

#### TC-USER-001: 收藏功能

| 项目 | 内容 |
|------|------|
| 用例ID | TC-USER-001 |
| 前置条件 | 用户已登录 |
| 测试步骤 | 1. 访问任意内容详情页<br>2. 点击收藏按钮<br>3. 访问 http://localhost:3000/favorites |
| 预期结果 | 收藏成功，收藏列表显示该内容 |

#### TC-USER-002: 订阅功能

| 项目 | 内容 |
|------|------|
| 用例ID | TC-USER-002 |
| 前置条件 | 用户已登录 |
| 测试步骤 | 1. 访问 http://localhost:3000/subscriptions-new<br>2. 创建关键词订阅<br>3. 访问订阅列表 |
| 预期结果 | 订阅创建成功，订阅列表显示新订阅 |

### 4.5 管理后台模块

#### TC-ADMIN-001: 用户管理

| 项目 | 内容 |
|------|------|
| 用例ID | TC-ADMIN-001 |
| 前置条件 | 管理员已登录 |
| 测试步骤 | 1. 访问 http://localhost:3000/admin/users<br>2. 查看用户列表<br>3. 禁用/启用用户 |
| 预期结果 | 用户列表正常显示，操作成功 |

#### TC-ADMIN-002: 内容管理

| 项目 | 内容 |
|------|------|
| 用例ID | TC-ADMIN-002 |
| 前置条件 | 管理员已登录 |
| 测试步骤 | 1. 访问 http://localhost:3000/admin/content<br>2. 进入各内容管理页面<br>3. 查看内容列表 |
| 预期结果 | 内容列表正常显示 |

#### TC-ADMIN-003: 数据同步

| 项目 | 内容 |
|------|------|
| 用例ID | TC-ADMIN-003 |
| 前置条件 | 管理员已登录 |
| 测试步骤 | 1. 访问 http://localhost:3000/admin/sync<br>2. 点击同步按钮<br>3. 查看同步状态 |
| 预期结果 | 同步任务启动，状态正常更新 |

---

## 5. API测试

### 5.1 认证接口测试

#### 发送验证码

```bash
curl -X POST http://localhost:3001/api/v1/email-verification/send \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","type":"register"}'
```

**预期响应**：
```json
{
  "code": 0,
  "message": "验证码发送成功",
  "data": null
}
```

#### 用户登录

```bash
curl -X POST http://localhost:3001/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"password123"}'
```

**预期响应**：
```json
{
  "code": 0,
  "message": "登录成功",
  "data": {
    "accessToken": "eyJhbGciOiJIUzI1NiIs...",
    "refreshToken": "eyJhbGciOiJIUzI1NiIs...",
    "user": {
      "id": "uuid",
      "email": "test@example.com",
      "nickname": "testuser"
    }
  }
}
```

#### 管理员登录

```bash
curl -X POST http://localhost:3001/api/v1/auth/admin/login \
  -H "Content-Type: application/json" \
  -d '{"email":"limx-admin@embodiedpulse.com","password":"limx123456"}'
```

#### 获取当前用户

```bash
curl http://localhost:3001/api/v1/auth/me \
  -H "Authorization: Bearer <access_token>"
```

### 5.2 内容接口测试

#### 获取论文列表

```bash
curl "http://localhost:3001/api/v1/papers?page=1&size=20"
```

**预期响应**：
```json
{
  "code": 0,
  "data": {
    "items": [...],
    "pagination": {
      "page": 1,
      "size": 20,
      "total": 100,
      "totalPages": 5
    }
  }
}
```

#### 获取视频列表

```bash
curl "http://localhost:3001/api/v1/videos?page=1&size=20"
```

#### 获取信息流

```bash
curl "http://localhost:3001/api/v1/feed?tab=recommend&page=1&size=20"
```

### 5.3 用户功能接口测试

#### 获取收藏列表（需登录）

```bash
curl http://localhost:3001/api/v1/favorites \
  -H "Authorization: Bearer <access_token>"
```

#### 添加收藏（需登录）

```bash
curl -X POST http://localhost:3001/api/v1/favorites \
  -H "Authorization: Bearer <access_token>" \
  -H "Content-Type: application/json" \
  -d '{"contentType":"paper","contentId":"<paper_id>"}'
```

#### 获取订阅列表（需登录）

```bash
curl http://localhost:3001/api/v1/subscriptions \
  -H "Authorization: Bearer <access_token>"
```

### 5.4 管理接口测试

#### 获取用户列表

```bash
curl http://localhost:3001/api/v1/admin/users \
  -H "Authorization: Bearer <admin_token>"
```

#### 获取统计数据

```bash
curl http://localhost:3001/api/v1/admin/stats \
  -H "Authorization: Bearer <admin_token>"
```

---

## 6. 自动化测试

### 6.1 前端单元测试

```bash
cd frontend

# 运行测试
npm test

# 监听模式
npm run test:watch

# 生成覆盖率报告
npm run test:coverage
```

### 6.2 后端单元测试

```bash
cd backend

# 运行测试
npm test

# 监听模式
npm run test:watch

# 生成覆盖率报告
npm run test:coverage
```

### 6.3 测试覆盖率目标

| 类型 | 目标覆盖率 |
|------|-----------|
| 语句覆盖率 | ≥ 70% |
| 分支覆盖率 | ≥ 60% |
| 函数覆盖率 | ≥ 70% |
| 行覆盖率 | ≥ 70% |

---

## 7. 性能测试

### 7.1 接口响应时间

| 接口 | 目标响应时间 | 测试方法 |
|------|--------------|----------|
| GET /api/v1/papers | < 300ms | curl 计时 |
| GET /api/v1/videos | < 300ms | curl 计时 |
| GET /api/v1/feed | < 500ms | curl 计时 |
| POST /api/v1/auth/login | < 200ms | curl 计时 |

**测试命令**：
```bash
# 测试接口响应时间
curl -w "Time: %{time_total}s\n" -o /dev/null -s http://localhost:3001/api/v1/papers
```

### 7.2 并发测试

```bash
# 使用 ab 工具进行并发测试
ab -n 1000 -c 100 http://localhost:3001/api/v1/papers

# 使用 wrk 工具
wrk -t4 -c100 -d30s http://localhost:3001/api/v1/papers
```

### 7.3 前端性能指标

| 指标 | 目标值 | 测试工具 |
|------|--------|----------|
| 首屏加载 (FCP) | < 1.5s | Chrome DevTools |
| 最大内容绘制 (LCP) | < 2.5s | Chrome DevTools |
| 累积布局偏移 (CLS) | < 0.1 | Chrome DevTools |
| 首次输入延迟 (FID) | < 100ms | Chrome DevTools |

### 7.4 性能测试报告模板

| 指标 | 目标值 | 实际值 | 状态 |
|------|--------|--------|------|
| 首屏加载(FCP) | < 1.5s | | |
| 最大内容绘制(LCP) | < 2.5s | | |
| API P95响应时间 | < 500ms | | |
| 并发用户数 | 100+ | | |

---

## 8. 安全测试

### 8.1 认证安全

| 测试项 | 测试方法 | 预期结果 |
|--------|----------|----------|
| 无Token访问 | 访问需认证接口 | 返回401 |
| Token过期 | 使用过期Token | 返回401 |
| 无效Token | 使用伪造Token | 返回401 |
| 密码加密 | 查看数据库 | 密码已bcrypt加密 |

**测试命令**：
```bash
# 无Token访问
curl http://localhost:3001/api/v1/favorites

# 预期返回 401
```

### 8.2 输入验证

| 测试项 | 测试方法 | 预期结果 |
|--------|----------|----------|
| SQL注入 | 输入SQL语句 | 参数化查询，无注入 |
| XSS攻击 | 输入脚本代码 | 内容被转义 |
| 参数校验 | 输入非法参数 | 返回参数错误 |

**SQL注入测试**：
```bash
curl -X POST http://localhost:3001/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com' OR '1'='1","password":"test"}'
```

### 8.3 权限控制

| 测试项 | 测试方法 | 预期结果 |
|--------|----------|----------|
| 普通用户访问管理接口 | 使用用户Token | 返回403 |
| 越权操作 | 操作他人数据 | 返回403 |

**权限测试命令**：
```bash
# 使用普通用户Token访问管理接口
curl http://localhost:3001/api/v1/admin/users \
  -H "Authorization: Bearer <user_token>"

# 预期返回 403
```

### 8.4 安全检查清单

| 检查项 | 状态 | 备注 |
|--------|------|------|
| JWT密钥分离 | ✅ | Access和Refresh使用不同密钥 |
| 密码加密存储 | ✅ | bcrypt (10 rounds) |
| 输入验证 | ✅ | Zod Schema验证 |
| XSS防护 | ✅ | React默认防护 + DOMPurify |
| SQL注入防护 | ✅ | Prisma ORM参数化查询 |
| CORS配置 | ✅ | 白名单域名 |
| 请求限流 | ✅ | express-rate-limit |

---

## 附录

### A. 测试环境地址

| 环境 | 前端地址 | 后端地址 |
|------|----------|----------|
| 开发 | http://localhost:3000 | http://localhost:3001 |
| 测试 | http://test.embodiedpulse.com | http://api.test.embodiedpulse.com |
| 生产 | https://embodiedpulse.com | https://api.embodiedpulse.com |

### B. 测试工具

| 工具 | 用途 | 安装命令 |
|------|------|----------|
| curl | API测试 | 系统自带 |
| ab | 并发测试 | `brew install httpd` |
| wrk | 性能测试 | `brew install wrk` |
| Chrome DevTools | 前端性能 | Chrome浏览器 |

---

**文档维护**：本文档应随项目演进持续更新。

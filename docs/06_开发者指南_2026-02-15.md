# Embodied Pulse 开发者指南

**产品名称**：Embodied Pulse（具身智能脉搏）  
**文档类型**：开发者指南  
**版本**：v1.0  
**更新日期**：2026-02-15  
**适用对象**：开发者、贡献者  

---

## 目录

1. [开发环境搭建](#1-开发环境搭建)
2. [项目结构说明](#2-项目结构说明)
3. [技术栈详解](#3-技术栈详解)
4. [开发规范](#4-开发规范)
5. [调试指南](#5-调试指南)
6. [常见问题](#6-常见问题)

---

## 1. 开发环境搭建

### 1.1 环境要求

| 工具 | 版本要求 | 说明 |
|------|----------|------|
| Node.js | >= 20.x | 运行环境 |
| npm | >= 10.x | 包管理器 |
| PostgreSQL | >= 15.x | 主数据库 |
| Redis | >= 7.x | 缓存服务 |
| Git | 最新版 | 版本控制 |

### 1.2 快速开始

```bash
# 1. 克隆项目
git clone <repository-url>
cd Embodied

# 2. 安装依赖
./scripts/init-project.sh

# 3. 启动数据库服务
docker-compose up -d

# 4. 配置环境变量
cp backend/.env.example backend/.env
cp frontend/.env.example frontend/.env.local

# 5. 初始化数据库
cd backend
npx prisma db push
npm run db:seed

# 6. 启动开发服务器
./scripts/start-dev.sh
```

### 1.3 环境变量配置

#### 后端环境变量 (backend/.env)

```env
# 数据库
DATABASE_URL="postgresql://user:password@localhost:5432/embodied"

# JWT
JWT_ACCESS_SECRET="your_access_secret"
JWT_REFRESH_SECRET="your_refresh_secret"

# 邮件服务
SMTP_USER="your_email@qq.com"
SMTP_PASS="your_authorization_code"

# Redis
REDIS_URL="redis://localhost:6379"
```

#### 前端环境变量 (frontend/.env.local)

```env
NEXT_PUBLIC_API_URL=http://localhost:3001
```

---

## 2. 项目结构说明

```
Embodied/
├── backend/                    # 后端服务
│   ├── src/
│   │   ├── controllers/        # 控制器层
│   │   │   ├── auth.controller.ts
│   │   │   ├── paper.controller.ts
│   │   │   ├── video.controller.ts
│   │   │   └── ...
│   │   ├── services/           # 业务逻辑层
│   │   │   ├── auth.service.ts
│   │   │   ├── email.service.ts
│   │   │   └── ...
│   │   ├── routes/             # 路由定义
│   │   ├── middleware/         # 中间件
│   │   │   ├── auth.middleware.ts
│   │   │   └── admin.middleware.ts
│   │   ├── utils/              # 工具函数
│   │   └── types/              # 类型定义
│   ├── prisma/
│   │   ├── schema.prisma       # 数据库模型
│   │   ├── schema.user.prisma  # 用户相关模型
│   │   └── seed.ts             # 种子数据
│   └── package.json
│
├── frontend/                   # 前端应用
│   ├── src/
│   │   ├── app/                # Next.js App Router
│   │   │   ├── (auth)/         # 认证相关页面
│   │   │   │   ├── login/
│   │   │   │   ├── register/
│   │   │   │   ├── forgot-password/
│   │   │   │   └── reset-password/
│   │   │   ├── admin/          # 管理后台
│   │   │   ├── community/      # 社区页面
│   │   │   ├── papers/         # 论文页面
│   │   │   └── ...
│   │   ├── components/         # 组件
│   │   │   ├── common/         # 通用组件
│   │   │   ├── layout/         # 布局组件
│   │   │   └── features/       # 功能组件
│   │   ├── lib/                # 工具库
│   │   │   ├── api/            # API客户端
│   │   │   └── utils/          # 工具函数
│   │   └── store/              # 状态管理
│   └── package.json
│
├── docs/                       # 项目文档
├── scripts/                    # 脚本文件
└── docker-compose.yml          # Docker配置
```

---

## 3. 技术栈详解

### 3.1 前端技术栈

| 技术 | 版本 | 用途 |
|------|------|------|
| Next.js | 14.2.x | React框架，支持SSR/SSG |
| React | 18.x | UI库 |
| TypeScript | 5.3.x | 类型安全 |
| Ant Design | 5.12.x | UI组件库 |
| Zustand | 4.x | 状态管理 |
| Axios | 1.x | HTTP客户端 |
| TailwindCSS | 3.x | 样式框架 |

### 3.2 后端技术栈

| 技术 | 版本 | 用途 |
|------|------|------|
| Express | 4.18.x | Web框架 |
| TypeScript | 5.3.x | 类型安全 |
| Prisma | 5.9.x | ORM |
| bcrypt | 5.x | 密码加密 |
| jsonwebtoken | 9.x | JWT认证 |
| nodemailer | 6.x | 邮件服务 |
| bull | 4.x | 任务队列 |

### 3.3 数据存储

| 服务 | 用途 |
|------|------|
| PostgreSQL | 主数据库，存储业务数据 |
| Redis | 缓存、会话、任务队列 |

---

## 4. 开发规范

### 4.1 代码风格

```bash
# 后端代码检查
cd backend
npm run lint

# 前端代码检查
cd frontend
npm run lint
```

### 4.2 Git提交规范

```
feat: 新功能
fix: 修复bug
docs: 文档更新
style: 代码格式调整
refactor: 代码重构
test: 测试相关
chore: 构建/工具相关
```

### 4.3 分支管理

```
main        # 主分支，稳定版本
develop     # 开发分支
feature/*   # 功能分支
bugfix/*    # 修复分支
release/*   # 发布分支
```

### 4.4 API设计规范

- RESTful风格
- 统一响应格式
- 版本控制：`/api/v1/`
- 认证：Bearer Token

---

## 5. 调试指南

### 5.1 后端调试

```bash
# 启动后端（开发模式）
cd backend
npm run dev

# 查看日志
tail -f logs/app.log

# Prisma Studio
npm run db:studio
```

### 5.2 前端调试

```bash
# 启动前端（开发模式）
cd frontend
npm run dev

# 访问 http://localhost:3000
```

### 5.3 数据库调试

```bash
# 打开Prisma Studio
cd backend
npm run db:studio

# 访问 http://localhost:5555
```

### 5.4 常用调试命令

```bash
# 检查数据库连接
cd backend
npx prisma db pull

# 重置数据库
npx prisma migrate reset

# 查看Redis数据
redis-cli
> KEYS *
```

---

## 6. 常见问题

### Q1: 数据库迁移失败？

```bash
# 重置数据库
cd backend
npx prisma migrate reset

# 重新推送schema
npx prisma db push
```

### Q2: 前端无法连接后端？

1. 检查后端是否启动（端口3001）
2. 检查环境变量 `NEXT_PUBLIC_API_URL`
3. 检查CORS配置

### Q3: JWT Token无效？

1. 检查JWT_SECRET配置
2. 检查Token是否过期
3. 尝试重新登录获取新Token

### Q4: 邮件发送失败？

1. 检查SMTP配置
2. 确认QQ邮箱已开启SMTP服务
3. 使用授权码而非登录密码

---

## 贡献指南

1. Fork项目
2. 创建功能分支：`git checkout -b feature/your-feature`
3. 提交代码：`git commit -m 'feat: add feature'`
4. 推送分支：`git push origin feature/your-feature`
5. 提交Pull Request

---

**文档维护**：本文档将随项目演进持续更新。
